---
import PageLayout from '@/layouts/PageLayout.astro'
import PageTitle from '@/components/PageTitle.astro'

import ProjectListItem from '@/components/ProjectListItem.astro'
import SectionTitleByStatus from '@/components/SectionTitleByStatus.astro'
import { filterProjects } from '@/utils/filter-projects'

import { getProjectsData } from '@/lib/data/projects-provider'

const projects = await getProjectsData()
const activeProjects = filterProjects(projects ?? [], 'active')
const completedProjects = filterProjects(projects ?? [], 'completed')

const topPadding = activeProjects.length > 0 ? 'mt-20' : ''
---

<PageLayout metaTitle='Projects'>
  <div class='flex justify-between'>
    <PageTitle
      title="Things I've made in an attempt to make my mark"
      subtitle="Goal: Don't stop learning."
    />
  </div>

  {projects.length == 0 && <p>No projects published.</p>}

  <!-- LIST VIEW -->
  <div class='mt-10'>
    {
      activeProjects.length > 0 && (
        <div>
          <div class='flex flex-col gap-6'>
            {activeProjects.map(project => (
              <ProjectListItem project={project} />
            ))}
          </div>
        </div>
      )
    }

    {
      completedProjects.length > 0 && (
        <div class={topPadding}>
          <SectionTitleByStatus
            title='Past'
            subtitle='Projects I worked on. Due to the nature of Internet businesses, not all are online.'
          />

          <div class='flex flex-col gap-6'>
            {completedProjects.map(project => (
              <ProjectListItem project={project} foreground={true} />
            ))}
          </div>
        </div>
      )
    }
  </div>
</PageLayout>
